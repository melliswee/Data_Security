# H2, Second course week

In the second lesson, we took a look at last week's homework and got some feedback. Major feedback for me was that I need to include more photos from the exercises that are done on the computer, e.g. installations, terminal- screenshots and the results. We also solved some problems other students had, like being unable to add Guest Additions (for Linux installations part) or being unable to install the VirtualBox itself. 

The new theory part was about the OWASP Top 10- vulnerabilities. To be able to protect against them, we need to understand the vulnerabilities, common attacks and ways to mitigate the threats. This week's [homework](https://terokarvinen.com/2021/data-security-2022p3-ict4tf022-3008/#h2) has some reading material about OWASP Top 10, listening one podcast from "Darknet Diaries" and picking and understanding one CVE (The Common Vulnerabilities and Exposures). Then we practise/recap some SQL in SQLZoo and do some hacking with WebGoat.

## z - reading

1. [A05:2021-Security Misconfiguration](https://owasp.org/Top10/A05_2021-Security_Misconfiguration/)

* Over 90 % of applications, that OWASP tested, had some security misconfiguration
* Security Misconfiguration takes on many forms, some of which are:
    * Improperly configuried permissions
    * Unnecessary features enabled or installed, e.g. ports, services, pages etc.
    * Default accounts and passwords remain and are unchanged (attackers will know default/common passwords and accounts)
    * Revealing too much, e.g. in stack traces or error messages, or directory listing is not disabled on  the server
    * It is a security misconfiguration to use vulnerable or outdated components (see OWASP A06:2021)

2. [A06:2021-Vulnerable and Outdated Components](https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/)

* Applications are, nowadays, mostly not written/coded by a single developer/team because they are often huge and complex. Instead, they have components and dependencies that have come from the outside, e.g. libraries and repositories that someone else made. All programs and software has bugs and vulnerabilities get discovered. The problems start when pathches are not made (components that are not updated any more) or programs don't get updated (because developer does not follow security bulletins or does not remember what components they have used or are unable to configure the patches correctly). 

* Versions of the components and their dependencies must be known. There needs to be an inventory. There needs to be vulnerability scans.
* Removing components and dependencies that are not needed.
* Using trusted and official sources over secure links.
* Remember that there can be components on the internet that have been specifically **designed** to create a vulnerability.

3. [A03:2021-Injection](https://owasp.org/Top10/A03_2021-Injection/)

* Injection is a vulnerability, where the attacker is able to introduce (= inject) their code into the target, e.g. a database. The injected code then might destroy data, sniff sensitive data or create a backdoor or whatever the attacker wants.
* Common injections are: SQL, NoSQL, OS command, ORM and many more.
* Injection vulnerabilites are exploited from the client-side, so, the server-side (and beyond) should never trust user input.
* Use parameterised interface and prepared statements, validate and sanitize all data coming in to the server. Limit amount of queries allowed (SQL controls) and check the output to prevent mass disclosure of records.

4. [Darknet Diaries](https://darknetdiaries.com/)

* Listened to a story, where a physical pentester, Jason, breaks into a wrong bank accidentally ([Ep 6: The Beirut Bank Job](https://darknetdiaries.com/episode/6/)).
* Physical pentesters use social engineering and confidence to get people to trust them, which allows them to do what they want and gain access to places they should not be allowed to go.
* Pentesting (and the possible attacker's) tactics include: walking with determination like you know where you're going, gaining trust by being seen coming from a "trusted side" (like the direction of boss' office or break room), wearing fake badges, having fake email as documentation for a job they're supposedly doing, walking through closed doors after someone...
* To protect againt these tactics, the simplest way is to train staff to always be wary or suspicious of strangers in the workplace and encourage them to act firmly when asking for documentation (people are often too afraid to seem "rude"). Security policies should include awareness training.

5. [CVE]()

* In this section, we are supposed to pick a CVE, explain it and why it matters.


## a - SQLZoo

For this assignment, I did revision of SQL basics with [SQLZoo](https://sqlzoo.net/wiki/SQL_Tutorial) by doing "0 SELECT basics" and "2 SELECT from World". The tasks were mostly easy because I've had two courses (only) about SQL and relational databases in Haaga-Helia, so most of my knowledge comes from those courses (Tietokannat ja tiedonhallinta ([SWD1TN003](https://opinto-opas.haaga-helia.fi/course_unit/SWD1TN003)) and Tietokannan suunnittelu ja toteutus ([SWD4TN025](https://opinto-opas.haaga-helia.fi/course_unit/SWD4TN025))). Though, SQLZoo did introduce me to some new commands like 'BETWEEN' and 'IN' (list) and reminded me on how to use ROUND.

The first part, "0 SELECT basics", had the very basics of using WHERE-clause:

![pic1](/assets/h2/sqlzoo_1.png)

Here, I learned IN-clause which I have not used before. I wondered if it has slower performance than simply using 'name='somename''? I tried searching but could not find a clear answer.

![pic2](/assets/h2/sqlzoo_2.png)

Here's an optional way of executing the previous search (that I've previously learned):

![pic2b](/assets/h2/sqlzoo_2b.png)

Here I learned the use of between instead of using '<=' and '=>'. In an old thread about this([stackoverflow](https://stackoverflow.com/questions/1630239/sql-between-vs-and)), it was said that there is no difference in performance between these two ways but using '>' and '<' has more control if needed (see below). 

![pic3](/assets/h2/sqlzoo_3.png)

Here's the another the way to solve this task. Reason for using this style would be when one wants to exclude some values ('WHERE number BETWEEN 3 and 5', would give 3, 4, 5 but if one does not want 3 included (so, the output would be 4 and 5), command 'WHERE number > 3 AND number <= 5' should be used).

![pic3b](/assets/h2/sqlzoo_3b.png)

I took the SELECT-quiz to do revision and nailed it.

![quiz](/assets/h2/quiz.png)
![quizresults](/assets/h2/quiz_result.png)

Second part ("2 SELECT from World") had first some easy and then more challenging tasks.

Selecting all wanted columns from World-table:

![pic1](/assets/h2/2_sqlzoo_1.png)

Selecting all countries with a simple WHERE-clause:

![pic2](/assets/h2/2_sqlzoo_2.png)

Selecting and having a simple equation with WHERE-clause:

![pic3](/assets/h2/2_sqlzoo_3.png)

Same type of equation. Here I used AS-clause to make the name of the column prettier:

![pic4](/assets/h2/2_sqlzoo_4.png)

Revision about using IN-clause to search multiple countries from database:

![pic5](/assets/h2/2_sqlzoo_5.png)

Using LIKE-clause for searching the word 'united'. I used the wildcard (%) on the both sides because I was not completely sure if 'united' could follow something.

![pic6](/assets/h2/2_sqlzoo_6.png)

WHERE-clause with OR. I used DISTICT-clause too, to avoid duplicate lines but the results did not differ when I did it without because, of course, there are no countries with the exact same name. So, in this case it was pointless to use DISTINCT:

![pic7](/assets/h2/2_sqlzoo_7.png)

This exclusive OR, XOR, was new SQL for me. I knew of the concept of XOR but I have not used it in SQL before: 

![pic8](/assets/h2/2_sqlzoo_8.png)

ROUND-clause ([source](https://sqlzoo.net/wiki/ROUND)) is used to round a number to the decimal place specified in the second parameter (ROUND(round_this, number of decimals)):

![pic9](/assets/h2/2_sqlzoo_9.png)

I learned that I can use a negative number (in this case -3) to round to the nearest 1000 ([source](https://www.geeksforgeeks.org/round-function-in-sql-server/)): 

![pic10](/assets/h2/2_sqlzoo_10.png)

This exercise was a revision on how to use LENGTH, it gives the number of letters in the given word:

![pic11](/assets/h2/2_sqlzoo_11.png)

In this exercise is shown how to use LEFT to isolate a specified number of letters from a word (here the first letter). I also learned that '<>' means NOT EQUALS.

![pic12](/assets/h2/2_sqlzoo_12.png)

The last exercise gave me the most difficulty, but at one point I thought I had written the command exactly like in the picture (which I copy-pasted from [stackoverflow](https://stackoverflow.com/questions/46932389/sql-query-show-name-with-all-vowels)) but it kept having some syntax error. I'm guessing this might be a slow database query because it has so many LIKE-clauses. 

![pic13](/assets/h2/2_sqlzoo_13.png)


