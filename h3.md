# H3, Third course week

In the third lesson we went through last weeks' homework. Injection attacks are easy to understand but it still wasn't that easy to do them if one does not write down the actual query you're making (i.e. "'SELECT salary FROM employee WHERE tan='113' OR '1'='1';--") and all the options you have already tried.

This week's homework ([course's website](https://terokarvinen.com/2021/data-security-2022p3-ict4tf022-3008/#h3)) includes reading about ATT&CK Framework and Cross Site Scripting (XSS). To understand XSS, we're to write a short story or a comic that describes the attack. Lastly, we learn hacking with WebGoat. 

## z - reading

**Assignment**

"Read and summarize (This subtask z does not require tests with a computer. Some bullets per article is enough for your summary, feel free to write more if you like)

* Mitre 2022: [ATT&CK Enterprise Matrix](https://attack.mitre.org/matrices/enterprise)
    * Give examples of a single, easy technique in each tactic. Which is the easiest?
    * Explain technique, subtechnique, tactic and procedure. Give example of each.
    * Describe a procedure (a brief description is enough, no need to repeat all steps listed)
* OWASP: [Cross Site Scripting (XSS)](https://owasp.org/www-community/attacks/xss/)"

**Notes and thoughts**

### ATT&CK:
* Question: Is this matrix a chain too like in the cyber kill chain, where the previous step has to succeed for the attack to be succesful? 
* "Tactics denoting short-term, tactical adversary goals during an attack (the columns)"([source](https://www.mcafee.com/enterprise/en-us/security-awareness/cybersecurity/what-is-mitre-attack-framework.html))
* "Techniques describing the means by which adversaries achieve tactical goals (the individual cells)"([source](https://www.mcafee.com/enterprise/en-us/security-awareness/cybersecurity/what-is-mitre-attack-framework.html))
* It looks like a subtechnique is a more narrow implementation (or an example?) of the ("super"-) technique, e.g. technique "Phishing" has a subtechnique "Spearphishing Attachment" and they're both under the "Initial Access"- tactic.
* Procedure examples seem to be either a group ([Transparent Tribe](https://attack.mitre.org/groups/G0134/)) or malware ([Valak](https://attack.mitre.org/software/S0476/)) that serves as an actual real-life example of a subtechnique that has been used. There seems to be a lot of procedures/examples for spearphishing attachments. 
* Tactics:
    * Reconnaisance: information gathering
        * Technique: "Search Open Websites/Domains", probably the easiest technique in recon because it is just regular surfing and "stalking" to research what the target has been doing and saying, for example, in social media.
    * Resource Development: preparation phase for the attacker to set support measures for targeting, e.g. setting email acoounts for phishing 
        * Technique: The easiest techinque may be the "Obtain capabilities" where the attacker buys or steals malware that they're going to use against the target. 
    * Initial Access: getting into the target's network
        * Technique: "Replication Through Removable Media" may be the easiest if the attacker is proficient in social engineering. I feel like all the stories that I've heard about physical pentesting have included getting inside the target with charms and sticking an USB into a computer that is connected to the target network. On the other hand, "Phishing" might be the most commonly used, practically risk-free(?) and cheap, so, it might actually be the easiest tactic, Attacker can just send a malicious email with an attachment or a link.
    * Execution: running the malicious code
        * Technique: "User Execution" following "Phishing" is probably the easiest if attacker has made a succesfull succesful social engineering feat, then, the victim might just open the malicious attachment or follow the attacker's link to where-ever.
    * Persistence: maintaining presence in the network
        * Technique: This tactic has many techical techniques, so, it is hard for me to know what might be the easiest technique. I'm guessing that if an attacker is able to use "Valid Accounts"- technique, it is a preferable choice because it is hard to detect the attack with this technique.
    * Privilege Escalation: gaining higher-level permissions
        * This tactic seems to share quite many of the same techniques that the "Persistence"- tactic had. I'm guessing that if the attacker finds a vulnerability, they will use the "Exploitation for Privilege Escalation"-technique to gain higher-level permissions.
    * Defense Evasion: avoiding detection
        * Technique: Again, many very technical techniques but the easiest might still be the "Valid Accounts"- technique if there are default accounts left open and their credentials are well known and this technique might allow the attacker remain undetected. "Weaken Encryption"- technique seems very intresting but is probably hard to do.
    * Credential Access: stealing account names and passwords (with keylogging or credential dumping)
        * Technique: "Brute Forcing"- technique might be very easy technique, if the attacker does it without causing account locking and uses password guessing because many people use weak passwords still.
    * Discovery: figuring out the environment
        * Technique: All of the techniques seem to focus on an important thing to know about the target's network. Without knowing that much about the tools, I'm guessing "File and Directory Discovery" might be an easy technique because I imagine that it is a very common thing to check and there might be many ready-made attack tools for it.
    * Lateral Movement: moving in the environment
        * Technique: I think that "Internal Spearphishing" might be an easy technique because it involves tricking people with internal trusted account and usually, the people, are the weakest link in the security. On the other hand, if a target organization's worker gets suspicious of the internal accounts phishing attack, would it reveal that there is an attacker? So, is this a risky technique?
    * Collection: gathering intresting data
        *  Technique: I'm guessing that if the target has their own physical devices (instead of using Cloud Services), the easiest thing might be to use "Data from Local System" because there is probably the most valuable data collected to a single place. And if the target enterprise is not a huge company, they might not have a dedicated ICT team to look after the devices and since renewing the devices might be very expensive and difficult, they could be outdated or running old software, thus making them vulnerable to attack.
    * Command and Control: communicating with the compromised network from the outside
        * Technique: The "Remote Access Software"- techique might be the easiest way to communicate with the network because it might be used legitimately in the enterprise already and it allows the attacker to do whatever they want. I'm guessing that it might be easy to social engineer someone to install a remote access software.
    * Exfiltration: stealing data
        * Technique: I chose "Exfiltration Over Web Service"- technique because it gives cover to the data transfer against network traffic systems, though, I do not know if it is the easiest technique. 
    * Impact: manipulate, destroy and interrupt
        * Technique: I think "Defacement"- techniques might be easy because it doesn't take much to lose customer's trust, thus, causing a lot of damage to the target.

### XSS: 



## y - Cross Site Story

**Assignment**

"Write a short story or draw a comic of a cross site scripting attack. Make roles clear: who attacks? Who runs, what code, where? What unauthorized access is gained? (This subtask y does not require any tests with a computer.)."

I have heard of XSS many times before, but never really understood how it actually happens, which is why I searched a video where someone demonstrates how the attack is done. I found Loi Liang Yang's YouTube- [video](https://www.youtube.com/watch?v=PPzn4K2ZjfY), "Cross-Site Scripting (XSS) Explained And Demonstrated By A Pro Hacker!". In the video he demonstrates the stored XSS- attack in WebGoat- environment and uses "Beef", which is a browser exploitation framework freely available. Here, I shortly explain what happens in the video that demonstrates the attack.

**Stored XSS - a Story**:
There was a hacker, named Phisher, who was surfing the vastness of the net and looking for an easy catch. They perused through many a product review-site and numerous message forums, poking here and there, and feeding the input fields with test scripts that have alerts. Until, at long last, a website hailed back at the Phisher and said "Hello World!" like they had waited. Now, a vulnerable input field had been found, a comment field that will run the Phisher's code, no questions asked. They rummaged their toolkit and found just the right thing, a browser exploitation framework called "Beef". "Beef" was a tool that every phisher worth their salt knew and shared with each other freely. Plenty of fish in the sea... "Beef" has many helpful features for a phisher, like graphic user interface in the browser and ready-made commands for several different phishing attacks among others. Phisher prepared their bait, a script- tag that had a catch, a hook.js- file from "Beef". Phisher clicked "Comment"-button, the website happily accepted and executed the code and stored the bait permanently in the database, where it would be found by anyone who came too close. Then started the waiting game. But it did not take long until someone else wanted to comment something and got hooked by the bait without them even noticing it. Fresh prey for the Phisher. The prey's unsuspecting browser had executed Phisher's hook-code because it came from a "trusted source", comment forum's own database. What a betrayal! Phisher smirked. They could see the victim's browser information in their "Beef"-interface, like victim's ip-address, language and plugins but it was some other information Phisher had in mind. They executed a social engineering command in "Beef", that made the message forum website to look like a Google account- login page. Phisher waited in suspense: "Will the prey fall for the fake login-page? Are they distrated enough?" Yes, they were! From their "Beef"-interface, Phisher could see their prize, the real Google login information, the username and the password, of the victim. What to do with this treasure?  

## a - WebGoat: A3 Sensitive Data Exposure

**Assignment**

* "Insecure Login: 2 Let's try"

## b - WebGoat: A7 Cross Site Scripting (XSS): Cross site scripting

**Assignment**

* "2 What is XSS?"
* "7 Try It! Reflected XSS"
